<reactiveUi:ReactiveUserControl x:TypeArguments="viewModels:ModPageViewModel"
                                xmlns="https://github.com/avaloniaui"
                                xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                                xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                                xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                                xmlns:viewModels="clr-namespace:Chrysalis.ViewModels"
                                xmlns:views="clr-namespace:Chrysalis.Views"
                                xmlns:mock="clr-namespace:Chrysalis.Mock;assembly=Chrysalis"
                                xmlns:ext="clr-namespace:Chrysalis.Extensions"
                                xmlns:i="clr-namespace:Projektanker.Icons.Avalonia;assembly=Projektanker.Icons.Avalonia"
                                xmlns:reactiveUi="http://reactiveui.net"
                                xmlns:c="clr-namespace:Chrysalis.Converters"
                                mc:Ignorable="d" d:DesignWidth="980" d:DesignHeight="550"
                                x:Class="Chrysalis.Views.ModPageView"
                                x:DataType="viewModels:ModPageViewModel"
                                d:DataContext="{x:Static mock:MockModPageViewModel.DesignInstance}"
                                Name="UserControl">
    <DockPanel Background="#2D0A1F">
        
        <!-- 进度条 -->
        <ProgressBar
            DockPanel.Dock="Bottom"
            MaxHeight="6"
            MinHeight="6"
            Name="Bar"
            Background="#3D2832"
            Foreground="#C75B7A"
            BorderBrush="#6B4A5A"
            BorderThickness="0"
            IsVisible="{Binding ProgressBarVisible}"
            IsIndeterminate="{Binding ProgressBarIndeterminate}"
            Minimum="0"
            Maximum="100"
            Value="{Binding Progress}" />

        <!-- 顶部工具栏 -->
        <Border DockPanel.Dock="Top"
                Margin="12 12 12 8"
                Background="#4A1230"
                BorderBrush="#6B4A5A"
                BorderThickness="1"
                CornerRadius="8"
                Padding="12">
            <Grid
                ColumnDefinitions="500,*,Auto,Auto"
                RowDefinitions="Auto, 8, Auto">
                
                <!-- 搜索框 -->
                <Border
                    Grid.Row="0"
                    Grid.Column="0"
                    Margin="0"
                    Padding="0"
                    Background="#3D2832"
                    BorderBrush="#8B2D54"
                    BorderThickness="1"
                    CornerRadius="6">
                    <DockPanel>
                        <i:Icon 
                            Margin="10 0 8 0" 
                            Value="fa-solid fa-magnifying-glass" 
                            Foreground="#D9A5B3"
                            VerticalAlignment="Center"/>
                        <TextBox
                            x:Name="Search"
                            Name="Search"
                            Watermark="{ext:Localize XAML_SearchMark}"
                            BorderThickness="0"
                            Background="Transparent"
                            Foreground="#D9A5B3"
                            CaretBrush="#E85D75"
                            Text="{Binding Search}" />
                    </DockPanel>
                </Border>
                
                <!-- BepInEx 安装按钮 -->
                <Button
                    Grid.Column="3"
                    Grid.Row="0"
                    Margin="8 0 0 0"
                    Classes="Primary"
                    Width="180"
                    Height="36"
                    Background="#8B2D54"
                    BorderBrush="#C75B7A"
                    BorderThickness="1"
                    CornerRadius="6"
                    Command="{Binding ToggleApi}"
                    VerticalAlignment="Center">
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <i:Icon Value="fa-solid fa-power-off" Foreground="#D9A5B3"/>
                        <TextBlock Text="{Binding BepInExButtonText}" Foreground="#D9A5B3" FontWeight="SemiBold"/>
                    </StackPanel>
                </Button>

                <!-- 过滤器 -->
                <Grid Grid.Column="0"
                      Grid.Row="2"
                      ColumnDefinitions="auto, *">
                    <Border
                        Grid.Column="0"
                        Margin="0"
                        VerticalAlignment="Center"
                        Background="#3D2832"
                        BorderBrush="#6B4A5A"
                        BorderThickness="1"
                        CornerRadius="6">
                        <StackPanel Orientation="Horizontal" Spacing="2" Margin="4">
                            <RadioButton
                                Classes="Small"
                                IsChecked="True"
                                Content="{ext:Localize XAML_ModsFilter_All}" 
                                Command="{Binding SelectAll}"
                                Foreground="#D9A5B3">
                                <RadioButton.Styles>
                                    <Style Selector="RadioButton:checked">
                                        <Setter Property="Foreground" Value="#E85D75"/>
                                    </Style>
                                </RadioButton.Styles>
                            </RadioButton>
                            <RadioButton 
                                Classes="Small"
                                Content="{ext:Localize XAML_ModsFilter_Installed}"
                                Command="{Binding SelectInstalled}"
                                Foreground="#D9A5B3">
                                <RadioButton.Styles>
                                    <Style Selector="RadioButton:checked">
                                        <Setter Property="Foreground" Value="#E85D75"/>
                                    </Style>
                                </RadioButton.Styles>
                            </RadioButton>
                            <RadioButton 
                                Classes="Small"
                                Content="{ext:Localize XAML_ModsFilter_Enabled}"
                                Command="{Binding SelectEnabled}"
                                Foreground="#D9A5B3">
                                <RadioButton.Styles>
                                    <Style Selector="RadioButton:checked">
                                        <Setter Property="Foreground" Value="#E85D75"/>
                                    </Style>
                                </RadioButton.Styles>
                            </RadioButton>
                            <RadioButton 
                                Classes="Small"
                                Content="{ext:Localize XAML_ModsFilter_OutOfDate}"
                                Command="{Binding SelectUnupdated}"
                                Foreground="#D9A5B3">
                                <RadioButton.Styles>
                                    <Style Selector="RadioButton:checked">
                                        <Setter Property="Foreground" Value="#E85D75"/>
                                    </Style>
                                </RadioButton.Styles>
                            </RadioButton>
                        </StackPanel>
                    </Border>

                    <!-- 标签过滤 -->
                    <ComboBox
                        Grid.Column="1"
                        Margin="8 0 0 0"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Center"
                        x:Name="TagBox"
                        PlaceholderText="Filter Tags"
                        ItemsSource="{Binding Tags, Mode=OneWay}"
                        Background="#3D2832"
                        BorderBrush="#6B4A5A"
                        Foreground="#D9A5B3"
                        CornerRadius="6"
                        Classes="Small" />
                </Grid>

                <!-- 打开Mods文件夹按钮 -->
                <Button 
                    Grid.Column="2"
                    Grid.Row="2"
                    Margin="8 0"
                    Height="36"
                    Background="#8B2D54"
                    BorderBrush="#C75B7A"
                    BorderThickness="1"
                    CornerRadius="6"
                    Command="{Binding OpenModsDirectory}"
                    VerticalAlignment="Center">
                    <Button.Styles>
                        <Style Selector="Button:pointerover">
                            <Setter Property="Background" Value="#C75B7A"/>
                        </Style>
                    </Button.Styles>
                    <StackPanel Orientation="Horizontal" Spacing="6">
                        <i:Icon Value="fa-regular fa-folder-open" Foreground="#D9A5B3"/>
                        <TextBlock Text="Open Mods" Foreground="#D9A5B3"/>
                    </StackPanel>
                </Button>

                <!-- 全部更新按钮 -->
                <Button 
                    Grid.Column="3"
                    Grid.Row="2"
                    Margin="0"
                    Height="36"
                    Background="#8B2D54"
                    BorderBrush="#C75B7A"
                    BorderThickness="1"
                    CornerRadius="6"
                    IsEnabled="{Binding CanUpdateAll}"
                    Command="{Binding UpdateAll}"
                    VerticalAlignment="Center">
                    <Button.Styles>
                        <Style Selector="Button:pointerover">
                            <Setter Property="Background" Value="#C75B7A"/>
                        </Style>
                        <Style Selector="Button:disabled">
                            <Setter Property="Opacity" Value="0.5"/>
                        </Style>
                    </Button.Styles>
                    <StackPanel Orientation="Horizontal" Spacing="6">
                        <i:Icon Value="fa-solid fa-rotate" Foreground="#D9A5B3"/>
                        <TextBlock Text="Update All" Foreground="#D9A5B3"/>
                    </StackPanel>
                </Button>
            </Grid>
        </Border>

        <!-- 分隔线 -->
        <Separator DockPanel.Dock="Top" Background="#6B4A5A" Margin="12 0"/>

        <!-- 主内容区 -->
        <SplitView
            Name="SplitView"
            DisplayMode="CompactInline"
            OpenPaneLength="510"
            PanePlacement="Left"
            IsPaneOpen="True"
            Background="#2D0A1F">

            <!-- 右侧 Mod 详情 -->
            <views:ModDetailsView />

            <!-- 左侧 Mod 列表 -->
            <SplitView.Pane>
                <views:ModListView />
            </SplitView.Pane>
        </SplitView>
    </DockPanel>
</reactiveUi:ReactiveUserControl>